colors {
  white {red = 255, green = 255, blue = 255}
  menuInteractiveRangeStart {red = 50, green = 50, blue = 50}
  menuInteractiveRangeEnd {red = 255, green = 255, blue = 255}
}

pixelStateCollections {
  auctionFound = [
    {type = ExactPixelMatch, x = 166, y = 407, rgb = ${colors.white}}
    {type = ExactPixelMatch, x = 166, y = 567, rgb = ${colors.white}}
    {type = ExactPixelMatch, x = 933, y = 447, rgb = ${colors.white}}
    {type = ExactPixelMatch, x = 520, y = 507, rgb = ${colors.white}}
    {type = ExactPixelMatch, x = 653, y = 240, rgb = ${colors.white}}
  ]

  auctionReady = [
    {type = ExactPixelMatch, x = 1486, y = 525, rgb = ${colors.white}}
    {type = ExactPixelMatch, x = 1559, y = 525, rgb = ${colors.white}}
    {type = ExactPixelMatch, x = 1486, y = 558, rgb = ${colors.white}}
    {type = ExactPixelMatch, x = 1559, y = 558, rgb = ${colors.white}}
  ]

  menuInteractiveCheck = [
    {type = RangedPixelMatch, x = 11, y = 34, rgbFrom = ${colors.menuInteractiveRangeStart}, rgbTo = ${colors.menuInteractiveRangeEnd}}
    {type = RangedPixelMatch, x = 11, y = 46, rgbFrom = ${colors.menuInteractiveRangeStart}, rgbTo = ${colors.menuInteractiveRangeEnd}}
    {type = RangedPixelMatch, x = 30, y = 41, rgbFrom = ${colors.menuInteractiveRangeStart}, rgbTo = ${colors.menuInteractiveRangeEnd}}
    {type = RangedPixelMatch, x = 36, y = 37, rgbFrom = ${colors.menuInteractiveRangeStart}, rgbTo = ${colors.menuInteractiveRangeEnd}}
  ]
}

// all helper actions (actions that will be used in several places) can be placed here
helperActions {
  waitForMenuInteractive = [
    {type = waitForPixelState, pixelStateCollection = ${pixelStateCollections.menuInteractiveCheck}}
  ]

  perkSelectAndConfirm = [
    {type = tapKey, keyEvent = VK_ENTER, duration = 15}
    {type = wait, duration = 250}
    {type = tapKey, keyEvent = VK_ENTER, duration = 15}
    {type = wait, duration = 3750}
  ]
}

// this is the only object that will *actually* be loaded into code
// it is represented as a Map<ModuleName, Map<ActionName, List<Instruction>>>
// as such it represents a heirarchy of ModuleName -> ActionName -> Instructions
actions {
  // acts as a namespace for all actions directly related to auctionFarming
  auctionFarming {
    verifyMainMenu = [
      {type = tapKey, keyEvent = VK_ENTER, duration = 15}
      {type = runAction, action = ${helperActions.waitForMenuInteractive}}
      {type = wait, duration = 200}
      {type = changeToAction, actionName = waitForAuctionFilter}
    ]

    waitForAuctionFilter = [
      {type = tapKey, keyEvent = VK_ENTER, duration = 15}
      {type = wait, duration = 1015}
      {
        type = probeScreen
        pixelStateCollection = ${pixelStateCollections.auctionFound}
        actionNameIfMatch = waitForAuctionReady
        actionNameElse = noAuctionFound
      }
    ]

    waitForAuctionReady = [
      {type = waitForPixelState, pixelStateCollection = ${pixelStateCollections.auctionReady}}
      {type = tapKey, keyEvent = VK_Y, duration = 30}
      {type = wait, duration = 250}
      {type = tapKey, keyEvent = VK_DOWN, duration = 30}
      {type = wait, duration = 10}
      {type = repeat, count = 12, action = [
        {type = tapKey, keyEvent = VK_ENTER, duration = 15}
        {type = wait, duration = 15}
      ]}
      {type = changeToAction, actionName = rollback}
    ]

    noAuctionFound = [
      {type = tapKey, keyEvent = VK_ESCAPE, duration = 30}
      {type = runAction, action = ${helperActions.waitForMenuInteractive}}
      {type = wait, duration = 200}
      {type = changeToAction, actionName = verifyMainMenu}
    ]

    rollback = [
      {type = wait, duration = 5000}
      {type = tapKey, keyEvent = VK_ENTER, duration = 30}
      {type = wait, duration = 2000}
      {type = tapKey, keyEvent = VK_ESCAPE, duration = 30}
      {type = wait, duration = 2000}
      {type = tapKey, keyEvent = VK_ESCAPE, duration = 30}
      {type = wait, duration = 5000}
      {type = changeToAction, actionName = verifyMainMenu}
    ]
  }

  // acts as a namespace for all actions directly related to porscheFarming
  porscheFarming {
    purchaseCar = [
      {type = tapKey, keyEvent = VK_ENTER, duration = 15}
      {type = wait, duration = 2000}
      {type = tapKey, keyEvent = VK_Y, duration = 15}
      {type = wait, duration = 350}
      {type = repeat, count = 7, action = [
        {type = tapKey, keyEvent = VK_DOWN, duration = 15}
        {type = wait, duration = 30}
      ]}
      {type = tapKey, keyEvent = VK_ENTER, duration = 15}
      {type = wait, duration = 100}
      {type = repeat, count = 5, action = [
        {type = tapKey, keyEvent = VK_DOWN, duration = 15}
        {type = wait, duration = 30}
      ]}
      {type = tapKey, keyEvent = VK_ENTER, duration = 15}
      {type = wait, duration = 100}
      {type = tapKey, keyEvent = VK_ESCAPE, duration = 15}
      {type = wait, duration = 350}
      {type = tapKey, keyEvent = VK_RIGHT, duration = 15}
      {type = wait, duration = 15}
      {type = tapKey, keyEvent = VK_ENTER, duration = 15}
      {type = wait, duration = 3500}
      {type = tapKey, keyEvent = VK_Y, duration = 15}
      {type = wait, duration = 660}
      {type = tapKey, keyEvent = VK_ENTER, duration = 15}
      {type = repeat, count = 2, action = [
        {type = wait, duration = 345}
        {type = tapKey, keyEvent = VK_ENTER, duration = 15}
      ]}
      {type = wait, duration = 14500}
      {type = changeToAction, actionName = purchaseComplete}
    ]

    purchaseComplete = [
      {type = tapKey, keyEvent = VK_ESCAPE, duration = 15}
      {type = wait, duration = 1300}
      {type = tapKey, keyEvent = VK_PAGE_DOWN, duration = 15}
      {type = wait, duration = 500}
      {type = tapKey, keyEvent = VK_RIGHT, duration = 15}
      {type = wait, duration = 50}
      {type = tapKey, keyEvent = VK_ENTER, duration = 15}
      {type = wait, duration = 1100}
      {type = tapKey, keyEvent = VK_DOWN, duration = 15}
      {type = wait, duration = 50}
      {type = tapKey, keyEvent = VK_ENTER, duration = 15}
      {type = wait, duration = 800}
      {type = runAction, action = ${helperActions.perkSelectAndConfirm}}
      {type = tapKey, keyEvent = VK_RIGHT, duration = 15}
      {type = wait, duration = 15}
      {type = runAction, action = ${helperActions.perkSelectAndConfirm}}
      {type = tapKey, keyEvent = VK_UP, duration = 15}
      {type = wait, duration = 15}
      {type = runAction, action = ${helperActions.perkSelectAndConfirm}}
      {type = tapKey, keyEvent = VK_UP, duration = 15}
      {type = wait, duration = 15}
      {type = runAction, action = ${helperActions.perkSelectAndConfirm}}
      {type = tapKey, keyEvent = VK_UP, duration = 15}
      {type = wait, duration = 15}
      {type = runAction, action = ${helperActions.perkSelectAndConfirm}}
      {type = tapKey, keyEvent = VK_LEFT, duration = 15}
      {type = wait, duration = 15}
      {type = runAction, action = ${helperActions.perkSelectAndConfirm}}
      {type = tapKey, keyEvent = VK_ESCAPE, duration = 15}
      {type = wait, duration = 800}
      {type = tapKey, keyEvent = VK_ESCAPE, duration = 15}
      {type = wait, duration = 1000}
      {type = tapKey, keyEvent = VK_PAGE_UP, duration = 15}
      {type = wait, duration = 500}
      {type = changeToAction, actionName = purchaseCar}
    ]

    sellCars = [
      {type = tapKey, keyEvent = VK_ENTER, duration = 15}
      {type = wait, duration = 315}
      {type = repeat, count = 4, action = [
        {type = tapKey, keyEvent = VK_DOWN, duration = 15}
        {type = wait, duration = 30}
      ]}
      {type = tapKey, keyEvent = VK_ENTER, duration = 15}
      {type = wait, duration = 400}
      {type = tapKey, keyEvent = VK_ENTER, duration = 15}
      {type = wait, duration = 1000}
    ]
  }
}